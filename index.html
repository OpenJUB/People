<!DOCTYPE html>

<html>

	<head>
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.js"></script>
	<script type="text/javascript" src="https://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

	<script type="text/javascript" src="js/jquery.appear.js"></script>
	<script type="text/javascript" src="js/openjub.js"></script>

	<script type="text/javascript">
		var c;
		var timeout = null;
		var lastLength = 0;

		function updateResults() {
			console.log("Updating results...");

			timeout = null;

			c.search($("#search").val(), [], 7000, 0, function(error, data) {
				if(!error) {
					var s = data.data;

					$("#frame").empty();

					s.map(function(e, idx) {
						$("#frame")
							.append($("<img></img>")
							.attr("src", e.picture)
							.attr("id", e.username)
							.attr("data-appear-top-offset", "600px"));
					});
				}
			});
		}



		$(function(){
			$("#search").focus();

			c = new JUB.Client("https://api.jacobs-cs.club");

			$("#search").on('input', function(evt) {
				if(timeout != null) {
					clearTimeout(timeout);
					timeout = null;
				}

				if($("#search").val().length > 3) {
					if($("#search").val().length < lastLength) {
						updateResults();
						lastLength = $("#search").val().length;
					} else {
						timeout = setTimeout(updateResults, 200);
					}
				}
			});

			$("#search").change(updateResults);
		});

	</script>

	<style type="text/css">
		body {
			background-color: black;
			margin: 0;
			padding: 0;

			color: white;
		}

		img {
			width: 96px;
			height: 128px;

			margin: 0;
			padding: 0;
		}

		#frame {
			padding-top: 128px;
			padding-left: 10em;
			padding-right: 10em;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
		}

		#searchbar {

		}

		#search {
			position: fixed;

			width: 75%;

			background-color: white;
			color: black;

			opacity: 0.85;

			font-size: 24pt;
			border-style: none;
			text-align: center;
			padding: 0.2em;
			margin: 1em 0 1em 12.5%;
		}

	</style>

	</head>

	<body>
		<div id="searchbar">
			<input type="text" placeholder="jStalker" id="search"></input>
		</div>


		<div id="frame">

		</div>
	</body>

</html>